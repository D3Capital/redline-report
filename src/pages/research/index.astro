---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

const siteName = "Redline Report";

const items = await getCollection("research");
// 最新在前
items.sort((a, b) => (a.data.date < b.data.date ? 1 : -1));
---

<Layout title="Research" siteName={siteName}>
  <header style="margin-bottom: 18px;">
    <h1 style="font-size: 34px; margin: 0 0 10px 0; color: #111827;">Research</h1>
    <p style="font-size: 16px; margin: 0; color: #374151; max-width: 760px; line-height: 1.65;">
      Independent risk research focused on corporate governance and disclosure integrity.
      Reports are versioned and updated with a change log.
    </p>
  </header>

  <section style="border-top: 1px solid #e5e7eb; padding-top: 18px;">
    <h2 style="font-size: 14px; margin: 0 0 12px 0; color: #111827; letter-spacing: 0.08em; text-transform: uppercase;">
      Latest
    </h2>

    <div style="display: grid; gap: 12px;">
      {items.length ? (
        items.map((e) => (
          <article style="border: 1px solid #e5e7eb; border-radius: 10px; padding: 14px;">
            <div style="font-size: 12px; color: #6b7280; letter-spacing: 0.08em; text-transform: uppercase; margin-bottom: 6px;">
              {(e.data.tag ?? "Published")} · {e.data.date}{e.data.version ? ` · ${e.data.version}` : ""}
            </div>

            <h3 style="margin: 0 0 6px; font-size: 18px; color: #111827;">
              <a href={`/research/${e.slug}`} style="color: inherit; text-decoration: none;">
                {e.data.title}
              </a>
            </h3>

            <p style="margin: 0; color: #374151; line-height: 1.6; max-width: 820px;">
              {e.data.summary}
            </p>
          </article>
        ))
      ) : (
        <article style="border: 1px solid #e5e7eb; border-radius: 10px; padding: 14px;">
          <div style="font-size: 12px; color: #6b7280; letter-spacing: 0.08em; text-transform: uppercase; margin-bottom: 6px;">
            Upcoming
          </div>
          <h3 style="margin: 0 0 6px; font-size: 18px; color: #111827;">
            First report will appear here
          </h3>
          <p style="margin: 0; color: #374151; line-height: 1.6;">
            Add a markdown file under <code>src/content/research/</code> to publish.
          </p>
        </article>
      )}
    </div>
  </section>
</Layout>